---
title: "REPLACE ME"
author: "Mateus de Lima Oliveira"
date: "28 de junho de 2019"
output:
  html_document:
    code_folding: "hide"
    toc: yes
    toc_depth: 5
    toc_float:
      collapsed: no
    df_print: paged
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(broom)
options(scipen = 999)
source(here::here("code/lib.R"))
theme_set(theme_bw())
```

```{r read}
atividade = read_projectdata()

atividade = atividade %>% 
  filter(!is.na(twitter), engaj_total > 0, engaj_mediano > 0, seguidores > 0, n_proprio > 0, n_retweet > 0)

atividade = atividade %>% 
  mutate(seguidores_log = log10(seguidores), 
         n_proprio_log = log10(n_proprio), 
         n_retweet_log = log10(n_retweet),
         segue_log = log10(segue),
         engaj_total_log = log10(engaj_total),
         engaj_mediano_log = log10(engaj_mediano))
```

##1. Qual a relação entre as características da atuação do parlamentar e o engajamento total que ele obtém no twitter? 

###Analisando relação entre variaveis

**Seguidores**

```{r warning=FALSE}
atividade %>%
  ggplot(aes(y = engaj_total_log, x = seguidores_log))+
  geom_point()
```

**Twittes**

```{r warning=FALSE}
atividade %>%
  ggplot(aes(y = engaj_total_log, x = n_proprio_log))+
  geom_point()
```

**Retweet**

```{r warning=FALSE}
atividade %>%
  filter(n_retweet > 0)%>%
  ggplot(aes(y = engaj_total_log, x = n_retweet_log))+
  geom_point()
```

**Segue**

```{r warning=FALSE}
atividade %>%
  filter(n_retweet > 0)%>%
  ggplot(aes(y = segue_log, x = n_retweet_log))+
  geom_point()
```


###Estimando o modelo de regressão linear múltipla.

O modelo considera que o cargo do parlamentar, a quantidade de seguidores e se _seguindo_, número de twittes próprios (n_proprio) e de retweets (n_retweet) têm influência no engajamento total.

```{r}

lm_engaj_total <- lm(engaj_total_log ~ casa + segue_log + seguidores_log + n_proprio_log + n_retweet_log , data = atividade)

tidy(lm_engaj_total)
glance(lm_engaj_total)
```
Considere **ET** = engajamento total, **CS** = casa do parlamentar, **RT** = número de retweets, **TP** = número de twittes próprios, **SG** = número de contas seguidas e **SGS** = número de seguidores. Além disso, o modelo foi gerado usando os dados com seu valor em log na base 10. Caso necessário, fazer a conversão para os valores originais. 

Os resultados da regressão indicam que um modelo no formato:  ET = **0.87**.RT + **0.5**.TP + **0.5**.SG + **0.56**.SGS **0.05**.CS   explicam **70,87%** da variância da variável de resposta (R² = 0.7087). 


*fazer a conversao*

O aumento de 1 unidade de RT *medida como/em [unidade]* produz uma mudança de *XXX* no engajamento. Portanto, é a variável de maior influência no valor final de ET, logo, um parlamentar que 

As restantes variáveis não parecem ter efeito sobre o o engajamento total.



###2. Qual a relação entre as características da atuação do parlamentar e o *engajamento mediano* que ele obtém no twitter? 

###Analisando relação entre variaveis

**Seguidores**

```{r warning=FALSE}
atividade %>%
  ggplot(aes(y = engaj_mediano_log, x = seguidores_log))+
  geom_point()
```

**Twittes**

```{r warning=FALSE}
atividade %>%
  ggplot(aes(y = engaj_mediano_log, x = n_proprio_log))+
  geom_point()
```

**Retweet**

```{r warning=FALSE}
atividade %>%
  filter(n_retweet > 0)%>%
  ggplot(aes(y = engaj_mediano_log, x = n_retweet_log))+
  geom_point()
```

**Segue**

```{r warning=FALSE}
atividade %>%
  filter(n_retweet > 0)%>%
  ggplot(aes(y = engaj_mediano_log, x = segue_log))+
  geom_point()
```

###Estimando o modelo de regressão linear múltipla.

O modelo considera que o cargo do parlamentar, a quantidade de seguidores e se _seguindo_, número de twittes próprios (n_proprio) e de retweets (n_retweet) têm influência no engajamento total.

```{r}
lm_engaj_mediano <- lm(engaj_mediano_log ~ casa + segue_log + seguidores_log + n_proprio_log + n_retweet_log , data = atividade)

tidy(lm_engaj_mediano)
glance(lm_engaj_mediano)
```
Considere **EM** = engajamento mediano, **CS** = casa do parlamentar, **RT** = número de retweets, **TP** = número de twittes próprios, **SG** = número de contas seguidas e **SGS** = número de seguidores. Além disso, o modelo foi gerado usando os dados com seu valor em log na base 10. Caso necessário, fazer a conversão para os valores originais. 

Os resultados da regressão indicam que um modelo no formato   EM = **(0.28)**.RT + **(-0.14)**.TP + **(-0.3)**.SG + **0.74**.SGS **(-0.10)**.CS   explicam **56,5%** da variância da variável de resposta (R² = 0.5653). 


Entretanto, assim como na primeira parte, o modelo foi gerado usando os dados com seu valor em log na base 10. Para calcular o modelo, é necessário fazer a conversão para os valores originais. 
*fazer a conversao*

O aumento de 1 unidade de RT *medida como/em [unidade]* produz uma mudança de *XXX* no engajamento. Portanto, é a variável de maior influência no valor final de ET, logo, um parlamentar que 

As restantes variáveis não parecem ter efeito sobre o o engajamento total.




